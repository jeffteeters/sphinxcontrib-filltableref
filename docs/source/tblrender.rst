tblrender
=========

The ``tblrender`` directive specifies what a summary table looks like (row and column titles and labels)
but without including referenced values.  It is used in the following way:

.. code-block:: rst


   .. _<table_name>:

   Title of table
   --------------

   Description of table (displayed only before rendered summary table, not before source
   tables.


   .. tblrender <table_name>
   :description:
      Description of table, displayed before each "source" table, which are generated by "tbldata" directives.
   << ptable specification >> AND/OR << gridtable specification >>


ptable specification
....................

<ptable specification> contains:

.. code-block:: rst

   :rows: <row title>, <row labels>
   :cols: <col title>, <col labels>
   :expanded_col_title: <expanded_col_title>
   :ct_offset: <ct_offset>


In the above:

<row title>
   is the title displayed in the top left cell of the table (above the row labels which are in the left-most
   column below the <row title>).

<row labels>
   is a list of the row labels, each element seperated by a comma.

<ct_offset>
   a non-negative integer specifying the number of columns after the first column, for which the <col label> is
   not an instance of the <col title>.  This is used to create tables in which there are one or more columns after
   the first column, that have their <col lable> not appear under the <col title>.  This is used both in
   creating the summary table header, and also in creating a column title for the values in the source tables.
   (The column title created for the source table values will be the concatination of the <column label>s that are
   not an instance of the <col title> and the <col title> with all parts seperated by " or ".  An example is
   shown below.

    
<expanded_col_title>
   REMOVE THIS.  is a title of the colums formed by combining any <column labels> in column numbers less than the <ct_offset> and
   the <col title>.  These are combined by concatening them, seperated by 


An example is below:

.. code-block:: rst

   :rows: "Source cell", "basket", "golgi", "granule", "purkinje", "stellate"
   :cols: "Target cell", "Cell count", "basket", "golgi", "granule", "purkinje", "stellate"
   :expanded_col_title: "Cell count or Target cell"
   :ct_offset: 2


gridtable specification
.......................


<gridtable specification> contains a ``:gridLayout:`` parameter followed by a Sphinx grid table, like:

.. code-block:: rst

   :gridLayout:
      +-------------+----------+------------------------------------------------------------------+
      |             |          |  Target cell                                                     |
      | Source      | Cell     +------------+------------+------------+-------------+-------------+
      | cell        | count    | basket     | golgi      | granule    | purkinje    | stellate    |
      +=============+==========+============+============+============+=============+=============+
      | basket      |          |      -     |            |            |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | golgi       |          |            |      -     |            |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | granule     |          |            |            |      -     |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | purkinje    |          |            |            |            |      -      |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | stellate    |          |            |            |            |             |      -      |
      +-------------+----------+------------+------------+------------+-------------+-------------+



Example
.......

An example showing both types of specifications is:


.. _table_loebner_fig2a:


Cells and connections in cat
----------------------------

The following table provides counts of cells and connections in the cat cerebellum.
The first two columns (*Source cell* and *Cell count*) are respectively a cell type
and the count (number) of cells of that type.  The values in the rest of the table
give the number of connections from the Source cell to Target cells.  These are
specified as a pair of numbers: FO,FI.  FO is fan-out (number of target cells each
source cell contacts) and FI is fan-in (number of source cells going to each target
cell).  Most of the data is from Figure 2 in :cite:`LoebnerEE-1989`, but new data will
be added.

.. code-block:: rst

   .. tblrender:: table_loebner_fig2a
      :rows: "Source cell", "basket", "golgi", "granule", "purkinje", "stellate"
      :cols: "Target cell", "Cell count", "basket", "golgi", "granule", "purkinje", "stellate"
      :expanded_col_title: "Cell count or Target cell"
      :ct_offset: 2
      :description:
         Values are either a Cell count, or FO,FI where FO is *fan-out* (number of target cells
         each source cell contacts) and FI is *fan-in* (number of source cells going to each
         target cell).
      :gridLayout:
         +-------------+----------+------------------------------------------------------------------+
         |             |          |  Target cell                                                     |
         | Source      | Cell     +------------+------------+------------+-------------+-------------+
         | cell        | count    | basket     | golgi      | granule    | purkinje    | stellate    |
         +=============+==========+============+============+============+=============+=============+
         | basket      |          |      -     |            |            |             |             |
         +-------------+----------+------------+------------+------------+-------------+-------------+
         | golgi       |          |            |      -     |            |             |             |
         +-------------+----------+------------+------------+------------+-------------+-------------+
         | granule     |          |            |            |      -     |             |             |
         +-------------+----------+------------+------------+------------+-------------+-------------+
         | purkinje    |          |            |            |            |      -      |             |
         +-------------+----------+------------+------------+------------+-------------+-------------+
         | stellate    |          |            |            |            |             |      -      |
         +-------------+----------+------------+------------+------------+-------------+-------------+
   

It is rendered as follows:


.. tblrender:: table_loebner_fig2a
   :rows: "Source cell", "basket", "golgi", "granule", "purkinje", "stellate"
   :cols: "Target cell", "Cell count", "basket", "golgi", "granule", "purkinje", "stellate"
   :expanded_col_title: "Cell count or Target cell"
   :ct_offset: 2
   :description:
      Values are either a Cell count, or FO,FI where FO is *fan-out* (number of target cells
      each source cell contacts) and FI is *fan-in* (number of source cells going to each
      target cell).
   :gridLayout:
      +-------------+----------+------------------------------------------------------------------+
      |             |          |  Target cell                                                     |
      | Source      | Cell     +------------+------------+------------+-------------+-------------+
      | cell        | count    | basket     | golgi      | granule    | purkinje    | stellate    |
      +=============+==========+============+============+============+=============+=============+
      | basket      |          |      -     |            |            |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | golgi       |          |            |      -     |            |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | granule     |          |            |            |      -     |             |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | purkinje    |          |            |            |            |      -      |             |
      +-------------+----------+------------+------------+------------+-------------+-------------+
      | stellate    |          |            |            |            |             |      -      |
      +-------------+----------+------------+------------+------------+-------------+-------------+
